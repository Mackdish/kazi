# Environment Variables Template

Copy these templates and fill in your actual API credentials when you have them.

## Frontend Environment Variables (.env.local)

```bash
# API & Base URLs
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Payment Gateway - Stripe
VITE_STRIPE_PUBLIC_KEY=pk_test_your_publishable_key_here

# Payment Gateway - M-Pesa
VITE_MPESA_CONSUMER_KEY=your_mpesa_consumer_key
VITE_MPESA_CONSUMER_SECRET=your_mpesa_consumer_secret
VITE_MPESA_ENVIRONMENT=sandbox  # Change to 'production' when live

# Payment Gateway - PayPal
VITE_PAYPAL_CLIENT_ID=your_paypal_client_id
VITE_PAYPAL_ENVIRONMENT=sandbox  # Change to 'production' when live

# App Settings
VITE_APP_NAME=nextgig
VITE_APP_ENV=development
```

## Backend Environment Variables (.env)

### Database & Auth
```bash
DATABASE_URL=postgresql://user:password@host:5432/database
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_URL=https://your-project.supabase.co
JWT_SECRET=your_jwt_secret_key
```

### Payment Gateway - Stripe
```bash
STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key
STRIPE_SECRET_KEY=sk_test_your_secret_key
STRIPE_WEBHOOK_SECRET=whsec_test_webhook_secret
STRIPE_API_VERSION=2023-10-16
```

### Payment Gateway - M-Pesa
```bash
MPESA_CONSUMER_KEY=your_mpesa_consumer_key
MPESA_CONSUMER_SECRET=your_mpesa_consumer_secret
MPESA_BUSINESS_SHORTCODE=123456  # Your business shortcode
MPESA_SHORTCODE_PASSKEY=your_shortcode_passkey
MPESA_ENVIRONMENT=sandbox  # Change to 'production' for live
MPESA_CALLBACK_URL=https://yourdomain.com/api/webhooks/mpesa
MPESA_TIMEOUT_URL=https://yourdomain.com/api/webhooks/mpesa/timeout
```

### Payment Gateway - PayPal
```bash
PAYPAL_CLIENT_ID=your_paypal_client_id
PAYPAL_CLIENT_SECRET=your_paypal_client_secret
PAYPAL_ENVIRONMENT=sandbox  # Change to 'production' for live
PAYPAL_WEBHOOK_ID=your_webhook_id
PAYPAL_API_ENDPOINT=https://api-m.sandbox.paypal.com  # Change for production
```

### Email Configurations (Optional)
```bash
SENDGRID_API_KEY=SG.your_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@nextgig.com
SENDGRID_FROM_NAME=nextgig Team

# Or use your own email service
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
```

### Cloud Storage (for uploads)
```bash
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_S3_BUCKET=nextgig-uploads
```

### Logging & Monitoring
```bash
LOG_LEVEL=info
NODE_ENV=development
DEBUG=false

# Sentry (Error Tracking)
SENTRY_DSN=https://key@sentry.io/projectid
SENTRY_ENVIRONMENT=development
```

### Server Configuration
```bash
PORT=3000
HOST=localhost
CORS_ORIGIN=http://localhost:5173
API_TIMEOUT=30000
MAX_REQUEST_SIZE=10mb
```

## How to Get Each API Key

### Stripe
1. Go to https://dashboard.stripe.com
2. Sign in or create account
3. Navigate to "Developers" → "API keys"
4. For testing: Use keys that start with `pk_test_` (public) and `sk_test_` (secret)
5. For production: Use keys that start with `pk_live_` and `sk_live_`
6. Copy from the dashboard and paste into your .env files

### M-Pesa (Safaricom)
1. Go to https://developer.safaricom.co.ke
2. Create or log into your developer account
3. Create a new application
4. Go to "Test Credentials" to find:
   - Consumer Key
   - Consumer Secret
   - Business Shortcode
   - Shortcode Passkey
5. Copy and paste into your .env files

### PayPal
1. Go to https://developer.paypal.com
2. Log in or create account
3. Go to "Apps & Credentials"
4. Select "Sandbox" tab
5. Find your credentials in the table
6. Copy Client ID and Secret
7. For Webhook ID: Go to "Notifications" → "Webhooks" and copy the ID

### Supabase
1. Go to https://app.supabase.com
2. Open your project
3. Go to "Project Settings" → "API"
4. Copy "Project URL" and "Anon Key"
5. For service role key: Go to "Service Role Secret" section

## Environment Variable Instructions

### Step 1: Create .env.local (Frontend)
```bash
# In your project root directory
cp .env.example .env.local  # If example exists
# Or create new file and add the Frontend variables above
```

### Step 2: Create .env (Backend)
```bash
# In your backend directory
cp .env.example .env  # If example exists
# Or create new file and add the Backend variables above
```

### Step 3: Add to .gitignore
```bash
.env
.env.local
.env.*.local
.env.production.local
.env.test.local
```

### Step 4: Load Environment Variables
**Node.js:**
```bash
npm install dotenv
# In your entry file:
import dotenv from 'dotenv';
dotenv.config();
```

**Vite (Frontend):**
```bash
# Automatically loads .env.local
# No additional setup needed
```

## Testing Your Configuration

### Frontend
```bash
# Check if Stripe is loaded
console.log(import.meta.env.VITE_STRIPE_PUBLIC_KEY)

# Try creating a PayPal order
import { createPayPalOrder } from '@/integrations/paypal/client'
```

### Backend
```bash
# Test Stripe connection
const stripe = require('stripe')(process.env.STRIPE_SECRET_KEY);
await stripe.balance.retrieve();

# Test PayPal connection
const client = new PayPalClient(...);
// Try creating an order

# Test M-Pesa credentials
const accessToken = await getMpesaAccessToken();
```

## Security Best Practices

1. **Never commit .env files** - Add to .gitignore
2. **Use different keys for environments**:
   - Development: Use sandbox/test keys
   - Production: Use live keys
3. **Rotate keys regularly** - Do this monthly for active providers
4. **Store securely** - Use environment variable management services:
   - Vercel Environment Variables
   - GitHub Secrets
   - AWS Secrets Manager
   - HashiCorp Vault
5. **Restrict key permissions** - Give payment keys only needed permissions
6. **Monitor usage** - Set up alerts for unusual activity

## Switching Between Environments

### Development (Sandbox)
```bash
VITE_STRIPE_PUBLIC_KEY=pk_test_xxx
STRIPE_SECRET_KEY=sk_test_xxx
VITE_PAYPAL_ENVIRONMENT=sandbox
MPESA_ENVIRONMENT=sandbox
```

### Production (Live)
```bash
VITE_STRIPE_PUBLIC_KEY=pk_live_xxx
STRIPE_SECRET_KEY=sk_live_xxx
VITE_PAYPAL_ENVIRONMENT=production
MPESA_ENVIRONMENT=production
```

## Troubleshooting

### "API Key not found"
- Check .env file exists in correct directory
- Restart dev server after adding .env file
- Ensure variable name exactly matches (case-sensitive)

### "Invalid API Key"
- Verify key is correct (no extra spaces)
- Check if using test key vs live key
- Verify key hasn't been revoked in provider dashboard

### Webhook not receiving calls
- Ensure callback URL is HTTPS (not HTTP)
- Check firewall allows webhook IPs
- Verify webhook URL in provider dashboard matches code

## Need Help?

1. Check `PAYMENT_INTEGRATION.md` for provider-specific setup
2. Review provider documentation (links in summary)
3. Look at integration test files for examples
4. Check your provider's webhook logs/dashboard

## Important Notes

⚠️ **Do NOT use test keys in production**
⚠️ **Do NOT share .env files in public repositories**
⚠️ **Do NOT commit API keys to version control**
✅ **Always use HTTPS for production webhooks**
✅ **Rotate keys when team members leave**
✅ **Keep track of which keys are used where**
